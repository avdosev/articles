# html2json

Как обычно мы храним в базе данных когда что-то нужно показать пользователю что обладает некоторомы свойствами разметки? Кто хотя бы раз делал свой блог, хабр или похожее сразу скажет - html. А что если я скажу что можно сделать иначе? JSON.

Я бы хотел рассмотреть преимущества и недостатки подобного хранения.

![Мем](./img/standarts_mem.jpg)

## Что? Json? Зачем это вообще надо?

типо я имею ввиду что основной профит - мы больше не должны поддерживать на клиенте некоторый набор легаси css или как то тяжело его обновлять. Достаточно обновить код преобразования джсон представления в хтмл

ну тоесть если мы захотим например как то обновить наше представление в юай то мы должны учитывать что на сервере весь хтмл содержит старые классы css и если мы придумаем вдруг какие то новые названия то все станет убогим и не красивым тк в самом хтмл названия не поменялись.

Т.е. это из области ssr, мы имеем готовый хтмл на сервере и дорендериваем его на клиенте? А зачем тогда на клиенте знать названия классов, которые приходят с сервера?

Скорее нет, чем да, это скорее из той области, когда мы не рендерим хтмл на сервере, а храним в бд, как, например, на всем известном хабре. *(Я конечно могу ошибаться, но смею предположить, что хабр хранит статьи именно в хтмл + оригинал того что прислал пользователь)*

## Небольшой бенчмарк

Давайте сначала рассмотрим небольшой бенчмарк

**далее тут код бенчмарка и его объяснение**

Скорость парсинга статьи полностью из джсона и с хтмл внутри джсона по производительности не имеет разницы

но интересно другое
 
но если вы используете React, например, вместе с либой "html_to_react", которая использует "html-dom-parser", то становится чуть интереснее:

* тестируем библиотеку только для построения dom дерева, замеры для "html_to_react" не проводились
* разница в производительности становится около 2-3 раз 

## Ок, а какие плюсы и минусы подобного решения?

плюсы:
1. Если делать подобное преобразование на сервере то в некоторых ситуациях можно немного ослабить нагрузку на гаджет пользователя
1. Независимость от хтмл
    
    Мы устраняем зависимость от того как хотим представлять на клиенте кнопку или спойлер, или цитату. независимы от css классов от различных атрибутов.

    Мы получаем возможность безболезненно создать на основе данных с сервера нативные виджеты, будь то андроид, ios, flutter, web или что-то из мира десктопа.

    И это все без WebView и аналогов.

1. Избавляемся от зависимостей

минусы:
1. json весит незначительно, но больше чем аналогичный html
1. json придется в любом случае конвертировать в нативный для данной платформы виджеты будь то веб с его хтмл или нативный мир уже с собственными особенностями
1. html очень многогранный и если есть необходимость поддерживать весь хтмл то, на мой взгляд, затея выглядит достаточно сомнительной и трудоемкой, (не придешь ли ты случайно к тому что изобретешь браузер)
1. вы создаете велосипед и поддерживать его придется вам

## Здорово, но я не смогу применить это на продукте...

Это все конечно хорошо, но как можно это применить?

Вот мой небольшой список:

1. 
1. думаю можно продолжать дальше, но я больше ничего не смог придумать

## Заключение